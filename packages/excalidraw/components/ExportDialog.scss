@use "../css/variables.module.scss" as vars;
@use "open-color/open-color" as oc;

// Color variables matching share menu
//:root {
//  --primary-lighter: oklch(0.961 0.021 295);
//  --primary-light: oklch(0.705 0.138 290);
//  --primary: oklch(0.547 0.158 288);
//  --primary-dark: oklch(0.334 0.092 288);
//  --primary-darker: oklch(0.289 0.043 291);
//  --primary-foreground: oklch(0.984 0.014 209);
//
//  --secondary-lighter: oklch(0.90 0.12 240);
//  --secondary-light: oklch(0.80 0.15 240);
//  --secondary: oklch(0.65 0.18 240);
//  --secondary-dark: oklch(0.50 0.18 240);
//  --secondary-darker: oklch(0.35 0.20 240);
//}

.excalidraw {
  // Keep existing preview styles
  .export-dialog .Island {
    padding: 0 !important;

    .Dialog {
      &__content {
        height: 100% !important;
        margin-top: 0 !important;
      }

      &__title {
        padding: 1rem 1.5rem;
        margin: 0 !important;

        &Content {
          font-size: 1.25rem;
          font-weight: 600;
        }
      }

      &__close {
        top: 1.25rem;
        right: 1rem;
      }
    }
  }

      .ExportDialog__preview {
        --preview-padding: calc(var(--space-factor) * 4);

        background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAMUlEQVQ4T2NkYGAQYcAP3uCTZhw1gGGYhAGBZIA/nYDCgBDAm9BGDWAAJyRCgLaBCAAgXwixzAS0pgAAAABJRU5ErkJggg==") left center;
        text-align: center;
        padding: var(--preview-padding);
        margin-bottom: calc(var(--space-factor) * 3);

        display: flex;
        justify-content: center;
        align-items: center;
      }

      .ExportDialog__preview canvas {
        max-width: calc(100% - var(--preview-padding) * 2);
        max-height: 25rem;
      }

      &.theme--dark .ExportDialog__preview canvas {
        filter: none;
      }

      // Redesigned Export Dialog styles
      .ExportDialog--redesigned {
        padding: 2rem 1.5rem;

        .ExportDialog__cards {
          display: flex;
          flex-direction: column;
          gap: 1.5rem;
        }
      }

      // Export Card - matches share menu card style
      .ExportCard {
        position: relative;
        padding: 1.5rem;
        border-radius: 0.5rem;
        border: 1px solid transparent;
        cursor: pointer;
        transition: all 0.2s ease;



        &--primary {
          background: linear-gradient(to bottom right,
                  color-mix(in oklch, var(--primary) 5%, transparent),
                  color-mix(in oklch, var(--primary) 10%, transparent)
          );
          border-color: color-mix(in oklch, var(--primary) 20%, transparent);

          &:hover {
            border-color: var(--primary);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
          }

          .ExportCard__icon {
            background: color-mix(in oklch, var(--primary-light) 10%, transparent);
            color: var(--primary);
          }

          &:hover .ExportCard__icon {
            background: color-mix(in oklch, var(--primary-light) 25%, transparent);
          }

          &:hover .ExportCard__arrow {
            color: var(--primary);
          }
        }

        &--secondary {
          background: linear-gradient(to bottom right,
                  color-mix(in oklch, var(--secondary) 5%, transparent),
                  color-mix(in oklch, var(--secondary) 10%, transparent)
          );
          border-color: color-mix(in oklch, var(--secondary) 20%, transparent);

          &:hover {
            border-color: var(--secondary);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
          }

          .ExportCard__icon {
            background: color-mix(in oklch, var(--secondary) 10%, transparent);
            color: var(--secondary);
          }

          &:hover .ExportCard__icon {
            background: color-mix(in oklch, var(--secondary) 25%, transparent);
          }

          &:hover .ExportCard__arrow {
            color: var(--secondary);
          }
        }
      }

      .ExportCard__header {
        display: flex;
        align-items: flex-start;
        justify-content: space-between;
        margin-bottom: 1rem;
      }

      .ExportCard__icon {
        width: 3rem;
        height: 3rem;
        border-radius: 0.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background-color 0.2s ease;

        svg {
          width: 1.5rem;
          height: 1.5rem;
        }
      }

      .ExportCard__arrow {
        width: 1.25rem;
        height: 1.25rem;
        color: var(--color-gray-40);
        transition: color 0.2s ease;
      }

      .ExportCard__title {
        font-size: 1rem;
        font-weight: 600;
        margin: 0 0 0.5rem 0;
        color: var(--text-primary-color);
      }

      .ExportCard__description {
        font-size: 0.875rem;
        color: var(--color-gray-60);
        margin: 0;
        line-height: 1.5;
      }

      // OR Divider
      .ExportDialog__divider {
        display: flex;
        align-items: center;
        gap: 1rem;

        &::before,
        &::after {
          content: "";
          flex: 1;
          height: 1px;
          background: var(--default-border-color, #e5e5e5);
        }
      }

      .ExportDialog__divider-text {
        font-size: 0.875rem;
        color: var(--text);
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }

      // Mobile styles
      @include vars.isMobile {
        .ExportDialog {
          display: flex;
          flex-direction: column;
        }

        .ExportDialog__actions {
          flex-direction: column;
          align-items: center;
        }

        .ExportDialog__actions > * {
          margin-bottom: calc(var(--space-factor) * 3);
        }

        .ExportDialog__preview canvas {
          max-height: 30vh;
        }

        .ExportDialog__dialog,
        .ExportDialog__dialog .Island {
          height: 100%;
          box-sizing: border-box;
        }

        .ExportDialog__dialog .Island {
          overflow-y: auto;
        }

        .ExportDialog--redesigned {
          padding: 1rem;

          .ExportDialog__cards {
            gap: 1rem;
          }
        }

        .ExportCard {
          padding: 1rem;
        }
      }

      // Keep legacy card styles for backward compatibility
      .ExportDialog--json:not(.ExportDialog--redesigned) {
        .ExportDialog-cards {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          justify-items: center;
          row-gap: 2em;

          @media (max-width: 460px) {
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            .Card-details {
              min-height: 40px;
            }
          }

          .ProjectName {
            width: fit-content;
            margin: 1em auto;
            align-items: flex-start;
            flex-direction: column;

            .TextInput {
              width: auto;
            }
          }

          .ProjectName-label {
            margin: 0.625em 0;
            font-weight: bold;
          }
        }
      }

      button.ExportDialog-imageExportButton {
        border: 0;

        width: 5rem;
        height: 5rem;
        margin: 0 0.2em;
        padding: 0;
        display: flex;
        align-items: center;
        justify-content: center;

        border-radius: 1rem;
        background-color: var(--button-color);
        box-shadow: 0 3px 5px -1px rgba(0, 0, 0, 0.28),
        0 6px 10px 0 rgba(0, 0, 0, 0.14);

        font-family: Cascadia, serif;
        font-size: 1.8em;
        color: oc.$oc-white;

        &:hover {
          background-color: var(--button-color-darker);
        }

        &:active {
          background-color: var(--button-color-darkest);
          box-shadow: none;
        }

        svg {
          width: 0.9em;
        }
      }
    }
